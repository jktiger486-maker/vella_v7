# CODEGEN-17 : EXECUTION GATE v1 (STATE â†’ ORDER ONLY)

## ëª©ì 
ì´ ë¬¸ì„œëŠ” VELLA_V7ì˜ **Execution Gate**ë¥¼ ì •ì˜í•œë‹¤.

ì›ì¹™:
- íŒë‹¨ âŒ
- ì „ëžµ âŒ
- ê³„ì‚° âŒ
- ì˜¤ì§ **State + Signal â†’ Order Intent** ë³€í™˜ë§Œ ìˆ˜í–‰

ðŸ‘‰ Executionì€ ë‘ë‡Œê°€ ì•„ë‹ˆë‹¤. ì†ì´ë‹¤.


============================================================
## 0. ë³€ê²½ ëŒ€ìƒ
============================================================

vella_v7/modules/execution/execution.py


- PIT-5 (State ë¶ˆë³€)
- PIT-6 (Signal ê³„ì•½)
- CODEGEN-16 (State Transition Gate)
- íŒë‹¨ ë¡œì§ ì¹¨ë²” âŒ
- Entry / Exit / Risk ê³„ì‚° âŒ


============================================================
## 1. ì„¤ê³„ í•µì‹¬ (ì£¼ì¸ë‹˜ í™•ì¸ìš©)
============================================================

- Executionì€ **Stateë¥¼ ì½ê¸°ë§Œ** í•œë‹¤
- Entry / Exit / RiskëŠ” **Signalë§Œ ì „ë‹¬**
- Executionì€ â€œë¬´ì—‡ì„ ì£¼ë¬¸í• ì§€â€ê°€ ì•„ë‹ˆë¼
  â€œì´ ìƒíƒœë©´ ì´ëŸ° ì£¼ë¬¸ì„ ë‚¸ë‹¤â€ë§Œ ì •ì˜

ðŸ‘‰ ì£¼ë¬¸ ì˜ë„(OrderIntent)ì™€
ðŸ‘‰ ì‹¤ì œ API í˜¸ì¶œì€ ë¶„ë¦¬ëœë‹¤ (v1ì—ì„œëŠ” í˜¸ì¶œ âŒ)


============================================================
## 2. execution.py (FULL CONTENT)
============================================================

```python
# ============================================================
# AUTO-GENERATED FILE â€” DO NOT EDIT MANUALLY
# SOURCE OF TRUTH: PIT-5, PIT-6, CODEGEN-17
# ============================================================

from typing import Optional
from vella_v7.contracts.contracts import (
    EngineState,
    EntrySignal,
    ExitSignal,
    OrderIntent,
)


def build_order_intent(
    state: EngineState,
    entry_signal: Optional[EntrySignal] = None,
    exit_signal: Optional[ExitSignal] = None,
) -> Optional[OrderIntent]:
    """
    Execution Gate v1

    Rules:
    - No decision logic
    - No calculations
    - No exchange calls
    """

    # --------------------------------------------------------
    # ENTRY â†’ OPEN POSITION
    # --------------------------------------------------------
    if entry_signal is not None:
        if state.has_position:
            return None

        return OrderIntent(
            action="OPEN",
            side=entry_signal.side,
            qty=entry_signal.qty,
            price=entry_signal.price,
        )

    # --------------------------------------------------------
    # EXIT â†’ CLOSE POSITION
    # --------------------------------------------------------
    if exit_signal is not None:
        if not state.has_position:
            return None

        return OrderIntent(
            action="CLOSE",
            side=state.side,
            qty=state.remaining_qty,
            price=None,  # market close
        )

    # --------------------------------------------------------
    # NO ORDER
    # --------------------------------------------------------
    return None

============================================================

3. ì˜ë„ì  ì œì•½ (ì¤‘ìš”)

============================================================

API í˜¸ì¶œ âŒ

ìŠ¬ë¦¬í”¼ì§€ ê³„ì‚° âŒ

ê°€ê²© ì¶”ì • âŒ

í¬ì§€ì…˜ íŒë‹¨ âŒ

Risk ê°œìž… âŒ

Executionì€ ìƒíƒœ ë²ˆì—­ê¸°ë‹¤.

============================================================

4. ì‹¤íŒ¨ ë°©ì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

============================================================

ì•„ëž˜ê°€ ë³´ì´ë©´ ì¦‰ì‹œ êµ¬ì¡° ë¶•ê´´ë‹¤.

if price > ...

if pnl < ...

exchange.place_order(...)

ê³„ì‚°ëœ qty

ë ˆë²„ë¦¬ì§€ ì¡°ìž‘

ðŸ‘‰ ì „ë¶€ ìœ„ë°˜

============================================================

5. ìµœì¢… ì„ ì–¸

============================================================

Executionì€ ìƒíƒœë¥¼ ì£¼ë¬¸ ì˜ë„ë¡œ ë°”ê¾¼ë‹¤

íŒë‹¨ì€ Entry / Exit / Riskì—ë§Œ ì¡´ìž¬í•œë‹¤

ì£¼ë¬¸ ì‹¤í–‰ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œë§Œ ì—°ê²°ëœë‹¤

ë‹¤ìŒ ë‹¨ê³„:
ì‹¤ì œ ê±°ëž˜ì†Œ ì—°ê²°ì€ ì™„ì „ížˆ ë¶„ë¦¬ëœ ì–´ëŒ‘í„°ì—ì„œë§Œ ìˆ˜í–‰
